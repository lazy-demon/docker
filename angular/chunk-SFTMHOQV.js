import{a as oe,b as j}from"./chunk-RYG4MD25.js";import{h as R,i as Z,j as ee,k as N,l as q,m as te,n as ie,o as ne,p as re}from"./chunk-EFF4K3LV.js";import{$a as k,$b as u,Aa as f,Da as D,F as P,G as V,I as S,Jb as Y,L as C,La as l,Lb as K,M as $,Ma as _,Na as w,Nb as J,P as x,Pa as G,Q as M,Ta as W,Yb as U,_a as Q,ab as H,ac as E,ba as s,ca as m,cb as L,fc as X,gc as A,j as I,ka as g,ma as d,na as z,ra as a,sa as c,ta as v,xa as F,za as b}from"./chunk-5UJTAZDB.js";var T=(()=>{let i=class i{constructor(t){this.apiService=t,this.riskScoreChanged=new I,this.riskScore="",this.platformId=""}setPlatformId(t){this.platformId=t}setRiskScore(t){this.getPlatformIdOfPlatformName(t)}calculateRiskScoreOfPlatformName(){this.apiService.sendGetRequest(u.RISKSCORE+this.platformId).subscribe(t=>{this.riskScore=t,this.riskScoreChanged.next(this.riskScore)})}getPlatformIdOfPlatformName(t){this.apiService.sendGetRequest(u.RECORDBYNAME+t).subscribe(e=>{this.setPlatformId(e),this.calculateRiskScoreOfPlatformName()})}};i.\u0275fac=function(e){return new(e||i)(S(A))},i.\u0275prov=P({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var y=class{};var B=(()=>{let i=class i{constructor(t,e){this.apiService=t,this.riskService=e,this.answersChanged=new I,this.answers=[]}updateAnswer(t,e){for(let r of this.answers)r.questionid===t&&(r.body=e,r.wasEdited=!0,this.answersChanged.next(this.answers.slice()))}createAnswerIfNull(t){for(let e of this.answers)if(e.questionid===t){e.wasCreated=!1,e.wasEdited=!1;return}this.createNewAnswer(t)}createNewAnswer(t){let e=new y;e.platformid=this.platformId,e.categoryId=this.categoryId,e.questionid=t,e.body="",e.wasCreated=!0,e.wasEdited=!1,this.answers.push(e)}getRecord(t,e,r){this.categoryId=e,this.apiService.sendGetRequest(u.RECORD+"/byName/"+t).subscribe(p=>{this.platformId=p.id,this.setAnswers(r)})}setAnswers(t){this.apiService.sendGetRequest(u.ANSWER+"/byCategory/"+this.platformId+"/"+this.categoryId).subscribe(e=>{this.answers=e;for(let r of t)this.createAnswerIfNull(r.id);this.answersChanged.next(this.answers.slice())})}saveAnswers(){let t=[],e=[];for(let r of this.answers)r.wasCreated?t.push(r):r.wasEdited&&e.push(r);t.length>0?this.apiService.sendPostRequest(u.ANSWERS,t).subscribe(r=>{this.updateAnswers(e),this.riskService.calculateRiskScoreOfPlatformName()}):e.length>0&&this.apiService.sendPutRequest(u.ANSWERS,e).subscribe(r=>{this.riskService.calculateRiskScoreOfPlatformName()})}updateAnswers(t){t.length>0&&this.apiService.sendPutRequest(u.ANSWERS,t).subscribe(e=>{this.riskService.calculateRiskScoreOfPlatformName()})}};i.\u0275fac=function(e){return new(e||i)(S(A),S(T))},i.\u0275prov=P({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();function ve(n,i){n&1&&(a(0,"div")(1,"mat-icon"),l(2,"info"),c()())}function be(n,i){if(n&1&&(a(0,"p",14),l(1),c()),n&2){let o=f(5);s(),_(o.errorMessage)}}function _e(n,i){if(n&1){let o=F();a(0,"div")(1,"input",12),b("ngModelChange",function(e){x(o);let r=f(4);return M(r.userAnswer=e)})("input",function(){x(o);let e=f(4);return M(e.validateInput())}),c(),g(2,be,2,1,"p",13),c()}if(n&2){let o=f(4);s(),d("ngModel",o.userAnswer),s(),d("ngIf",o.errorMessage)}}function Ce(n,i){if(n&1&&(a(0,"div",11),l(1),g(2,_e,3,2,"div",8),c()),n&2){let o=f().$implicit,t=f(2);s(),w(" ",t.findsAnswerById(o.id).body," "),s(),d("ngIf",o.extrainfoanswer!=null)}}function we(n,i){n&1&&v(0,"div")}function ye(n,i){if(n&1&&(a(0,"div",11),l(1),g(2,we,1,0,"div",8),c()),n&2){let o=f().$implicit,t=f(2);s(),w(" ",t.findsAnswerById(o.id).body," "),s(),d("ngIf",o.extrainfoanswer!=null)}}function Se(n,i){if(n&1){let o=F();a(0,"tr")(1,"td",5)(2,"div",6)(3,"div",7),l(4),c(),g(5,ve,3,0,"div",8),c()(),a(6,"td",9),b("blur",function(e){let p=x(o).$implicit,h=f(2);return M(h.updateAnswerBody(p.id,e))})("input",function(e){let p=x(o).$implicit,h=f(2);return M(h.isItSaved(p.id,e))}),g(7,Ce,3,2,"div",10)(8,ye,3,2,"div",10),c()()}if(n&2){let o=i.$implicit,t=f(2);s(),D("title",o.extraInfo),s(3),w(" ",o.questionBody," "),s(),d("ngIf",o.extraInfo!=null&&o.extraInfo!==""),s(),D("title",o.extrainfoanswer),d("contentEditable",t.editable),s(),d("ngIf",t.isRiskCategory()),s(),d("ngIf",!t.isRiskCategory())}}function xe(n,i){if(n&1&&(a(0,"table",1)(1,"thead")(2,"tr",2)(3,"th",3),l(4),c(),a(5,"th",3),l(6),c()()(),a(7,"tbody"),g(8,Se,9,7,"tr",4),c()()),n&2){let o=f();s(4),_(o.category.categoryBody),s(2),_(o.category.categoryBody==="Risico"?"Aantal meldingen":""),s(2),d("ngForOf",o.questions)}}var ae=(()=>{let i=class i{constructor(t,e,r,p,h){this.questionService=t,this.editMode=e,this.answerService=r,this.route=p,this.savedChangesService=h,this.answers=[],this.editable=!1,this.userAnswer="",this.errorMessage=""}ngOnInit(){this.route.params.subscribe(t=>{this.platformName=t.platformName}),this.answerSubscription=this.answerService.answersChanged.subscribe(t=>{this.answers=t}),this.editSubscription=this.editMode.modeChanged.subscribe(t=>{this.category.editable&&(this.editable=t)}),this.questionSubscription=this.questionService.questionsChanged.subscribe(t=>{this.questions=t,this.answers&&this.answerService.getRecord(this.platformName,this.category.id,this.questions)}),this.questionService.setQuestions(this.category.categoryBody),this.category.editable&&(this.editable=this.editMode.editMode),this.submitSubscription=this.editMode.onSubmitChanged.subscribe(t=>{this.answerService.saveAnswers()})}ngOnDestroy(){this.editSubscription.unsubscribe(),this.questionSubscription.unsubscribe(),this.answerSubscription.unsubscribe(),this.submitSubscription.unsubscribe()}findsAnswerById(t){for(let e of this.answers)if(e.questionid===t)return e;return new y}updateAnswerBody(t,e){let r=e.target.innerText;this.answerService.updateAnswer(t,r)}isItSaved(t,e){let r=this.findsAnswerById(t),p=e.target.innerText;r.body!==p?this.savedChangesService.changeSavedChanges(!1):this.savedChangesService.changeSavedChanges(!0)}validateInput(){/^\d+$/.test(this.userAnswer)?this.errorMessage="":this.errorMessage="Alleen cijfers zijn toegestaan."}isRiskCategory(){return this.category.categoryBody.toLowerCase()==="risico"}};i.\u0275fac=function(e){return new(e||i)(m(j),m(R),m(B),m(E),m(N))},i.\u0275cmp=C({type:i,selectors:[["app-overview-category"]],inputs:{category:"category"},features:[G([j,B])],decls:1,vars:1,consts:[["class","table table-responsive table-bordered table-striped table-hover",4,"ngIf"],[1,"table","table-responsive","table-bordered","table-striped","table-hover"],[1,"table-subheader"],["contenteditable","false"],[4,"ngFor","ngForOf"],["contentEditable","false","data-toggle","tooltip","data-placement","right",3,"title"],[1,"rows"],[1,"questionBody"],[4,"ngIf"],["data-toggle","tooltip","data-placement","right",3,"contentEditable","title","blur","input"],["class","answer-field",4,"ngIf"],[1,"answer-field"],["type","text","id","answer",3,"ngModel","ngModelChange","input"],["style","color: red;",4,"ngIf"],[2,"color","red"]],template:function(e,r){e&1&&g(0,xe,9,3,"table",0),e&2&&d("ngIf",!!r.questions&&r.questions.length>0)},dependencies:[k,H,q,Y,K,J],styles:["*[_ngcontent-%COMP%]{cursor:pointer}tr[_ngcontent-%COMP%]{min-height:38px;height:38px;overflow:hidden;word-wrap:break-word;white-space:normal}th[_ngcontent-%COMP%]{width:50%;min-height:38px;overflow:hidden;word-wrap:break-word}.table[_ngcontent-%COMP%]{border-collapse:unset;overflow:hidden;table-layout:fixed}.table-striped[_ngcontent-%COMP%]{background-color:#8e606f40}.table-subheader[_ngcontent-%COMP%]{background-color:#202859;color:#fff;font-size:110%}#mapping[_ngcontent-%COMP%]{width:80%}#mapping-table[_ngcontent-%COMP%]{min-width:65vw}.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%], .table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   th[_ngcontent-%COMP%]{background-color:#8e606f66}mat-icon[_ngcontent-%COMP%]{color:#9d9d9d}.rows[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.answer-field[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}info-icon[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translate(-50%)}.editbtn[_ngcontent-%COMP%]{background-color:#975c8d;border-radius:5px;border-color:#975c8d;color:#fff;margin-outside:5px;float:right;justify-content:flex-end;padding:5px;margin-bottom:5px}.lastEdited[_ngcontent-%COMP%]{position:absolute;margin-top:10px;margin-left:3px}.opslbutton[_ngcontent-%COMP%]{background-color:#975c8d;border-radius:5px;border-color:#975c8d;color:#fff;margin-outside:5px;padding:5px}"]});let n=i;return n})();function Oe(n,i){if(n&1&&v(0,"app-overview-category",7),n&2){let o=i.$implicit;d("category",o)}}var Ie=(n,i)=>({"green-button":n,"red-button":i}),ce=(()=>{let i=class i{constructor(t,e,r,p,h){this.categoryService=t,this.route=e,this.editMode=r,this.riskService=p,this.savedChangesService=h,this.editable=!1,this.savedChanges=!0}ngOnInit(){this.savedChangesSubscription=this.savedChangesService.savedChangesChanged.subscribe(e=>{this.savedChanges=e}),this.route.params.subscribe(e=>{this.platformName=e.platformName}),this.riskScoreSubscription=this.riskService.riskScoreChanged.subscribe(e=>{this.riskScore=e}),this.categorySubscription=this.categoryService.categoriesChanged.subscribe(e=>{this.categories=e}),this.riskService.setRiskScore(this.platformName),this.editMode.editMode&&this.editMode.toggleMode(),this.categoryService.setCategories(),this.categories=this.categoryService.getCategories();let t=window.innerHeight*.2;window.onscroll=()=>{let e=document.querySelector(".bringtotop");window.pageYOffset>t?e.style.opacity="1":e.style.opacity="0"}}ngOnDestroy(){this.categorySubscription.unsubscribe(),this.riskScoreSubscription.unsubscribe(),this.savedChangesSubscription.unsubscribe()}switchEditMode(){this.editMode.toggleMode(),this.editable=this.editMode.editMode}onSubmit(){this.savedChangesService.changeSavedChanges(!0),this.editMode.onSubmit()}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}};i.\u0275fac=function(e){return new(e||i)(m(oe),m(E),m(R),m(T),m(N))},i.\u0275cmp=C({type:i,selectors:[["app-platform-overview"]],decls:19,vars:8,consts:[[1,"pull-left"],[1,"badge","text-bg-info","riscscore"],[1,"pull-toright"],[3,"click"],[3,"ngClass","click"],[3,"category",4,"ngFor","ngForOf"],[1,"bringtotop",3,"click"],[3,"category"]],template:function(e,r){e&1&&(a(0,"body")(1,"div")(2,"h2"),l(3),c()(),a(4,"div",0)(5,"h1")(6,"span",1),l(7,"Risicoscore: "),a(8,"strong"),l(9),c()()()(),a(10,"div",2)(11,"button",3),b("click",function(){return r.switchEditMode()}),l(12),c(),a(13,"button",4),b("click",function(){return r.onSubmit()}),l(14," Opslaan "),c()(),g(15,Oe,1,1,"app-overview-category",5),a(16,"button",6),b("click",function(){return r.scrollToTop()}),a(17,"mat-icon"),l(18,"arrow_upward"),c()()()),e&2&&(s(3),w(" Platformmapping: ",r.platformName," "),s(6),_(r.riskScore),s(3),_(r.editable?"Lezen":"Bewerken"),s(),d("ngClass",W(5,Ie,r.savedChanges,!r.savedChanges)),s(2),d("ngForOf",r.categories))},dependencies:[Q,k,q,ae],styles:["body[_ngcontent-%COMP%]{padding-left:20px;width:95%;font-family:Raleway,sans-serif}span[_ngcontent-%COMP%]{float:right}h2[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:2.5rem}.badge[_ngcontent-%COMP%]{padding:1.5rem;background-color:#975c8d;font-size:60%;font-weight:lighter}.categoryButtons[_ngcontent-%COMP%]{position:relative;background:#676886;color:#fff;border-radius:14px;padding:1rem}.categoryNav[_ngcontent-%COMP%]{padding-bottom:3vh;padding-top:3vh}button[_ngcontent-%COMP%]{border-radius:14px;padding:1.7rem;font-size:1.7rem}.green-button[_ngcontent-%COMP%]{background-color:#00b894;color:#fff}.red-button[_ngcontent-%COMP%]{background-color:#d63031;color:#fff}.nav-link[_ngcontent-%COMP%]{color:#fff;background-color:#6d7fac}.active[_ngcontent-%COMP%]{background-color:#4c5d84}.nav-link[_ngcontent-%COMP%]:hover{background-color:#975c8d}.pull-toright[_ngcontent-%COMP%]{padding-bottom:2rem;float:right}.riscscore[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:1rem}.bringtotop[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:52%;transform:translate(-50%);z-index:1000;opacity:0;transition:opacity .5s ease-in-out}"]});let n=i;return n})();var de=(()=>{let i=class i{constructor(t){this.navBarStateService=t,this.isCollapsed=!1,this.navBarStateService.isCollapsed$.subscribe(e=>{this.isCollapsed=e})}};i.\u0275fac=function(e){return new(e||i)(m(ee))},i.\u0275cmp=C({type:i,selectors:[["app-rapportages"]],decls:5,vars:2,consts:[[1,"row"],[1,"col-sm-1"],[1,"content"]],template:function(e,r){e&1&&(a(0,"body")(1,"div",0),v(2,"nav-bar",1),a(3,"div",2),v(4,"app-platform-overview"),c()()()),e&2&&(s(3),z("margin-left",r.isCollapsed?150:250,"px"))},dependencies:[ie,ce],styles:["nav[_ngcontent-%COMP%]{position:relative;justify-content:center;left:4vw}body[_ngcontent-%COMP%]{padding-left:20px}#table[_ngcontent-%COMP%]{font-family:Roboto,Helvetica Neue,sans-serif}.content[_ngcontent-%COMP%]{transition:margin-left .5s ease-in-out}"]});let n=i;return n})();var it=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=$({type:i}),i.\u0275inj=V({imports:[L,ne,X.forChild([{path:"",canActivate:[re],component:de}]),te,Z,U]});let n=i;return n})();export{it as PlatformMappingModule};
